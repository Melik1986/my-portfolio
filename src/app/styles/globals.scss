@use '../styles/_variables' as *;
@use '../styles/_mixins' as *;
@use '../styles/_normalize' as *;
@use '../styles/_reboot' as *;
// @use '../styles/_fonts' as *; // Отключено: конфликт с Next.js font optimization
@use '../styles/_container' as *;
@use '../styles/_visually-hidden' as *;
@use '../styles/_animations' as *;

/* Scroll lock for preloader */
html.preload-lock,
body.preload-lock {
  overflow: hidden !important;
  height: 100%;
}

/* FOUC Prevention: Hide content until preloader and smoother are ready */
html:not(.preloader-ready) main,
html:not(.preloader-ready) .ai-content-wrapper,
html:not(.preloader-ready) .portfolio__section,
html.preloader-ready:not(.smoother-ready) main,
html.preloader-ready:not(.smoother-ready) .ai-content-wrapper,
html.preloader-ready:not(.smoother-ready) .portfolio__section {
  visibility: hidden !important;
  opacity: 0 !important;
}

/* Show content only when both ready flags are set */
html.preloader-ready.smoother-ready main,
html.preloader-ready.smoother-ready .ai-content-wrapper,
html.preloader-ready.smoother-ready .portfolio__section {
  visibility: visible !important;
  opacity: 1 !important;
  transition: opacity 0.3s ease-out;
}

/* Theme variables */
:root[data-theme='light'] {
  @include light-theme-variables;
}

:root[data-theme='dark'] {
  @include dark-theme-variables;
}

/* Global navigation variables */
:root {
  /* Navigation text shadows - Light theme defaults */
  --nav-link-shadow:
    0 1px 0 #cccccc, 0 2px 0 #c9c9c9, 0 3px 0 #bbb, 0 4px 0 #b9b9b9, 0 5px 0 #aaa,
    0 6px 1px rgba(0, 0, 0, 0.1), 0 0 5px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.3),
    0 3px 5px rgba(0, 0, 0, 0.2), 0 5px 10px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.2),
    0 20px 20px rgba(0, 0, 0, 0.15);

  --button-text-shadow:
    0 0.5px 0 #cccccc, 0 1px 0 #c9c9c9, 0 1.5px 0 #bbb, 0 2px 0 #b9b9b9, 0 2.5px 0 #aaa,
    0 6px 1px rgba(0, 0, 0, 0.1), 0 0 5px rgba(0, 0, 0, 0.1), 0 1px 3px rgba(0, 0, 0, 0.3),
    0 3px 5px rgba(0, 0, 0, 0.2), 0 5px 10px rgba(0, 0, 0, 0.25), 0 10px 10px rgba(0, 0, 0, 0.2),
    0 20px 20px rgba(0, 0, 0, 0.15);

  --nav-link-shadow-hover:
    0 0 8px rgba(0, 230, 255, 0.7), 0 0 16px rgba(0, 230, 255, 0.5),
    0 0 32px rgba(0, 230, 255, 0.3), 0 1px 0 #cccccc, 0 2px 0 #c9c9c9, 0 3px 0 #bbb,
    0 4px 0 #b9b9b9, 0 5px 0 #aaa, 0 6px 1px rgba(0, 0, 0, 0.1), 0 0 5px rgba(0, 0, 0, 0.1),
    0 1px 3px rgba(0, 0, 0, 0.3), 0 3px 5px rgba(0, 0, 0, 0.2), 0 5px 10px rgba(0, 0, 0, 0.25),
    0 10px 10px rgba(0, 0, 0, 0.2), 0 20px 20px rgba(0, 0, 0, 0.15);

  /* Default section backgrounds (fallbacks when data-theme is not present) */
  --project-bg: var(--color-bg-surface);
  /* Default preloader background fallback (used before theme is applied) */
  --preloader-bg: #90e0ef;
  /* Default AI content wrapper background fallback */
  --ai-content-wrapper-bg: #c2e8ff;
}

/**
 * Базовые стили для портфолио
 * Определяет основную структуру и стили для всех секций
 */
.portfolio {
  width: 100%;
  min-height: 100dvh;

  /** Обертка для всех секций портфолио */
  &__section {
    overflow: hidden;
    position: relative;
  }

  &__floating-lang {
    position: fixed;
    top: 12px;
    right: 12px;
    z-index: 1000;
  }

  &__wrapper {
    height: 100dvh;
  }

  &__list {
    justify-content: flex-start;
    align-items: center;
    height: 100%;
    display: flex;
    position: relative;
    padding: 0;
    margin: 0;
    list-style: none;
  }

  &__item {
    width: 100%;
    height: 100%;
    display: flex;
    position: absolute;
    inset: 0%;
    box-shadow: rgb(149, 157, 165, 0.2) 0px 8px 24px;
    overflow: hidden;
  }

  &__title {
    font-size: $font-h6;
    text-shadow: 0.04em 0.04rem 0 #81b5ab;
  }
}

// Глобальная оптимизация для всех ECharts элементов
canvas[data-zr-dom-id] {
  touch-action: pan-y;
  will-change: transform;
}

div[_echarts_instance_] {
  touch-action: pan-y;
  will-change: transform;
}

// Медиа-запросы для горизонтальной ориентации (landscape)
@media screen and (orientation: landscape) {
  .portfolio {
    &__section {
      flex-direction: row;
      padding: 1rem;
      min-height: 100dvh;
    }

    &__wrapper {
      height: 100dvh;
      padding: 1rem;
    }
  }

  // Адаптация для мобильных устройств в landscape
  @media (max-height: 500px) {
    .portfolio {
      &__section,
      &__wrapper {
        padding: 0.5rem;
      }
    }

    .hero,
    .about,
    .skills,
    .projects-catalog {
      padding: 0.5rem;
    }
  }
}
